## 背景
后端计划从 Python/FastAPI 迁移至 Node.js 技术栈。该变更涉及运行时、依赖管理、向量检索存储与核心流程实现，属于架构级变更并允许破坏性变更。

## 目标 / 非目标
- 目标：
  - 使用 Node.js + Fastify + TypeScript 实现完整后端能力
  - 使用 PostgreSQL + pgvector 作为向量存储与检索后端
  - 覆盖现有功能（导入/索引/检索/问答）
- 非目标：
  - 不新增多用户或复杂权限体系
  - 不做大规模性能优化或分布式扩展

## 决策
- 选择 Fastify 作为 HTTP 框架
  - 理由：性能较好、插件体系成熟、结构轻量，迁移成本更低
- 使用 LangChain.js 作为 AI 编排框架
  - 理由：生态成熟、组件齐全，利于快速拼装与后续扩展
- 使用 TypeScript 作为主要开发语言
  - 理由：提升类型安全与可维护性，降低迁移风险
- 使用 PostgreSQL + pgvector 作为向量存储
  - 理由：结构化数据与向量检索统一存储，部署与运维简单
- 不保留 Python 代码与实现
  - 理由：避免双栈维护与技术债
- 全部数据迁移到 PostgreSQL
  - 理由：统一存储与运维流程

## 风险 / 取舍
- 迁移过程中可能出现功能回归
  - 缓解：建立回归测试清单并分阶段验证
- 需要维护数据库迁移与数据重建流程
  - 缓解：提供索引重建脚本与迁移说明

## 迁移计划
1. 建立 Node.js + Fastify + TypeScript 骨架与配置
2. 迁移配置加载与日志初始化
3. 迁移 health 与 /agent API
4. 实现 PostgreSQL 连接与 pgvector 向量索引/检索
5. 迁移导入、索引、检索、回答链路
6. 清理 Python 依赖与旧实现
7. 补齐测试与文档

## 待确认
- 无（按当前指示：不保留 Python 代码，全部迁移到 PostgreSQL）
